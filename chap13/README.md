## 텐서플로에서 데이터 적재

메모리 용량에 맞지 않는 아주 큰 규모의 데이터 셋으로 딥러닝을 훈련해야하는 경우 텐서플로우 데이터 API로 쉽게 처리할 수 있다.

대용량 데이터를 효율적으로 읽는 것은 기본적으로 정규화와 같은 데이터 전처리과정이 필요하다.

그리고 일반적으로 데이터가 수치만으로 구성되어있는 경우는 거의 없고, 텍스트 특성이나 범주형 특성등 다양한 타입의 데이터가 존재한다.

이런형태의 데이터의 경우 숫자로 바꿔주는 과정을 거쳐야 한다.

텐서플로우의 데이터API는 다양한 데이터 타입을 읽을 수 있고, 쉽게 처리가 가능해서 좋다.

데이터 API에서는 데이터셋의 map()메서드로 동적으로 전처리하거나, 전처리 층을 모델에 포함시켜 쉽게 처리할 수 있다.

-	임데딩을 사용하여 범주형 특성 인코딩하기
  
  임베딩은 범주를 표현하는 훈련가능한 밀집벡터이다.
  
  임베딩은 처음에 랜덤하게 초기화 되어있고, 훈련을 하면서 비슷한 범주들은 경사하강법에 의해 더 가까워지게 되어 모델이 향상된다.

경사 하강법은 훈련 세트에 있는 샘플이 독립적이고 동일한 분포를 가질 때 최고의 성능을 발휘한다.

학습을 할 때 이러한 조건을 만드는 간단한 방법은 shuffle()메서드를 사용하여 샘플을 섞는것이다.

전처리 과정은 계산비용이 크기 때문에 훈련과 동시에 수행하는것보다 사전에 처리하여 속도를 크게 높일 수 있다.

즉, 데이터가 훈련하는 동안 에포크마다 전처리되는 것이 아니라 훈련하기 전에 샘플마다 한번씩만 전처리된다.

다만 문제점은 모델을 훈련하고 배포를 한다고 가정하였을 때 나중에 주입될 데이터를 전처리하기 위해 추가적인 코드가 필요하다.

만약 전처리 과정이 바뀌게 된다면 코드를 일일이 다 수정해야하기 때문에 시간이 많이 걸릴뿐더러 에러가 생기기 쉬워 유지 및 보수를 아주 어렵게 만든다.

그리고 훈련 전에 수행한 전처리 연산과 앱이나 브라우저에서 수행하는 전처리가 차가 나는 훈련/서빙 왜곡이 발생하여 버그나 성능 감소로 이어질 수 있다.

따라서 이를 어느정도 해결하기 위해 전처리를 담당하는 층을 동적으로 추가하거나 TF변환을 해야한다.

TF변환은 기계 학습 및 데이터 전처리 작업을 수행하기 위한 라이브러리 중 하나로 데이터 파이프라인을 구축하고 변환을 수행하는 데 사용된다.

TF변환은 데이터 정규화 및 전처리과정이 쉽고, 누락된 데이터 처리도 가능하며 모델 학습에 사용할 특성을 선택하거나 변환할 수 있어 대규모 데이터셋을 처리하고 학습 모델에 공급하기 유용하다.




